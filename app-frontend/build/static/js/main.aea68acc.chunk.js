(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,a){e.exports=a.p+"static/media/profilepic.53c18c21.svg"},105:function(e,t,a){e.exports=a.p+"static/media/ico_active.383d95fd.svg"},106:function(e,t,a){e.exports=a.p+"static/media/close-btn.3d388d91.svg"},111:function(e,t,a){e.exports=a(195)},167:function(e,t){},176:function(e,t){},178:function(e,t){},195:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(25),o=a.n(r),i=a(16),c=a(28),l=a(99),p=a(24),d={loading:!1},m=Object(c.c)({chatReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_LOADER":return Object(p.a)({},e,{loading:!0});case"STOP_LOADER":return Object(p.a)({},e,{loading:!1});case"SHOW_NOTIFY":return Object(p.a)({},e,{data:{type:t.payload.type,show:!0,message:t.payload.message}});case"HIDE_NOTIFY":return Object(p.a)({},e,{data:{show:!1}});case"CURRENT_MESSAGES":return Object(p.a)({},e,{allmessages:t.payload.allmessages});case"PREVIOUS_MESSAGES":return Object(p.a)({},e,{allmessages:t.payload.allmessages.concat(e.allmessages)});case"NEW_MESSAGE":return Object(p.a)({},e,{allmessages:e.allmessages.concat(t.payload.message)});case"ACTIVE_USERS":return Object(p.a)({},e,{activeusers:t.payload.activeusers});default:return e}}}),u=Object(c.a)(l.a),g=Object(c.d)(m,u),h=a(56),f=a(8);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var v=a(20),y=a(21),E=a(22),S=a(23),N=a(217),O=a(218),w=a(219),b=a(216),_=a(214),j=a(215);a(61);function T(){return s.a.createElement("div",null,s.a.createElement(_.a,{position:"static",className:"shared-header"},s.a.createElement(j.a,{variant:"dense",className:"center-all",style:{height:56}},s.a.createElement(b.a,{className:"org-header-title",gutterBottom:!0},"Chatting App"))))}var R=a(35),I=a.n(R),x="http://3.135.224.242:4080",A=a(33),C=new A.a;var k=function(e){return e({type:"STOP_LOADER"})},H=function(e){if(console.log(e),e&&e.code&&(401==e.code||498==e.code))return window.location.replace("/")},W=function(e){Object(S.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).nameHandleChange=function(e){n.setState({isNameError:!1,name:e.target.value})},n.groupnameHandleChange=function(e){n.setState({isGroupNameError:!1,groupname:e.target.value})},n.joingroup=function(){if(n.state.name||n.state.groupname)if(n.state.name)if(n.state.groupname){var e={name:n.state.name,groupname:n.state.groupname};n.props.joinGroup(e).then(function(e){var t={uname:n.state.name,groupname:n.state.groupname,aid:e.data.data.aid,gid:e.data.data.gid};e.data.success&&e.data.data.gid&&n.props.history.push({pathname:"/chatgroup",state:{data:t}})})}else n.setState({isGroupNameError:!0});else n.setState({isNameError:!0});else n.setState({isNameError:!0,isGroupNameError:!0})},n.state={name:"",groupname:"",isNameError:!1,isGroupNameError:!1},n}return Object(y.a)(a,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(T,null),s.a.createElement(b.a,{className:"org-signup-form-heading",gutterBottom:!0},"Join chat group"),s.a.createElement("div",{className:"row center-all no-margin no-padding"},s.a.createElement(N.a,{className:"col-xl-4 col-lg-6  col-sm-6 org-login-card-container"},s.a.createElement(O.a,null,s.a.createElement("div",{className:""},s.a.createElement(b.a,{className:"org-signup-detail-title",gutterBottom:!0},"Name"),s.a.createElement("input",{type:"text",required:!0,className:this.state.isNameError?"org-signup-input-field org-err-input":"org-signup-input-field",placeholder:"Ex : pavneet",value:this.state.name,onChange:this.nameHandleChange}),this.state.isNameError?s.a.createElement("p",{className:"org-error-msg"},"Please enter your name"):null,s.a.createElement(b.a,{className:"org-signup-detail-title",gutterBottom:!0,style:{marginTop:24}},"Group Name"),s.a.createElement("input",{type:"text",required:!0,className:this.state.isGroupNameError?"org-signup-input-field org-err-input":"org-signup-input-field",placeholder:"Ex : Chat Club",value:this.state.groupname,onChange:this.groupnameHandleChange}),this.state.isGroupNameError?s.a.createElement("p",{className:"org-error-msg"},"Please enter Group name"):null,s.a.createElement(w.a,{variant:"contained",className:"org-signup-btn org-signup-detail-title-margin",onClick:this.joingroup},"Join"))))))}}]),a}(n.Component),M={joinGroup:function(e){return function(t){var a={method:"POST",data:{name:e.name,groupname:e.groupname},url:x+"/user/joingrp"};return function(e,t){e({type:"START_LOADER"})}(t),I()(a).then(function(e){return k(t),e&&e.data.success&&e.data?(C.set("a_id",e.data.data.aid,{path:"/"}),e):t({type:"SHOW_NOTIFY",payload:{type:"error",message:"Something went wrong",dispatch:t}})}).catch(function(e){var a="Something went wrong";return e.response&&e.response.statusText&&(a=e.response.statusText),e.response&&e.response.data&&e.response.data.err&&(a=e.response.data.err),e&&e.response&&e.response.data&&H(e.response.data||{}),k(t),t({type:"SHOW_NOTIFY",payload:{type:"error",message:a,dispatch:t}})})}}},U=Object(f.f)(Object(i.b)(function(e){return{}},M)(W)),Y=a(45),G=a(101),F=a.n(G),P=a(102),D=a.n(P),L=new A.a,B=function(e){var t=!1,a=L.get("a_id");return e.account&&a==e.account._id&&(t=!0),s.a.createElement("div",null,t?s.a.createElement("div",{className:"message-box-section sent-section"},s.a.createElement("div",{className:"message-sender-name "},"You",e.is_admin?s.a.createElement("span",{className:"message-admin"},"Admin"):null),s.a.createElement("div",{className:"message-text"},e.msg)):s.a.createElement("div",{className:"message-box-section received-section"},s.a.createElement("div",{className:"message-sender-name"},e.account?e.account.name:null,e.is_admin?s.a.createElement("span",{className:"message-admin"},"Admin"):null),s.a.createElement("div",{className:"message-text"},e.msg)))},V=a(103),J=a.n(V);function q(e){return!e||!0!==e.loading&&"true"!==e.loading?null:s.a.createElement("div",null,s.a.createElement("div",{className:"visible-loader"}))}var z=a(104),K=a.n(z),Q=a(105),$=a.n(Q),X=F()(x),Z=(new D.a({api_key:"test"}),function(e){Object(S.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).scrollToBottom=function(){n.messagesEnd.scrollIntoView({behavior:"smooth"})},n.handleMsgChange=function(e){n.setState({msg:e.target.value})},n.sendMessage=function(e){e.preventDefault(),n.props.checkProfanity(n.state.msg).then(function(e){if(e.data&&e.data.status)if(e.data.profanity&&e.data.profanity.matches&&e.data.profanity.matches.length>0)console.log("profanity found");else{var t={msg:n.state.msg,aid:n.state.aid,gid:n.state.gid};n.props.sendMessage(X,t).then(function(e){n.setState({msg:""})})}}).catch(function(e){console.log(e)})},n.paneDidMount=function(e){e&&e.addEventListener("scroll",n.handleScroll.bind(Object(Y.a)(n)))},n.handleScroll=function(e){var t=e.target,a={aid:n.state.aid,gid:n.state.gid,tim:n.props.chatReducer.allmessages[0].createdAt,previous_msg:!0};0===t.scrollTop&&(n.setState({showLoading:!0}),n.props.fetchChatHistory(a).then(function(e){n.setState({showLoading:!1}),e.data.data.allmessages.length>14&&(t.scrollTop=parseInt(t.clientHeight/2))}))},n.getActiveUsers=function(){n.props.getActiveUser({gid:n.state.gid})},n.state={msg:"",name:n.props.history.location&&n.props.history.location.state&&n.props.history.location.state.data?n.props.history.location.state.data.name:"",groupname:n.props.history.location&&n.props.history.location.state&&n.props.history.location.state.data?n.props.history.location.state.data.groupname:"",aid:n.props.history.location&&n.props.history.location.state&&n.props.history.location.state.data?n.props.history.location.state.data.aid:"",gid:n.props.history.location&&n.props.history.location.state&&n.props.history.location.state.data?n.props.history.location.state.data.gid:"",showLoading:!1},n}return Object(y.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.scrollToBottom();var t={aid:this.state.aid,gid:this.state.gid,tim:(new Date).getTime()};this.props.joinSocket(X,t),this.props.fetchChatHistory(t),X.on("ev",function(t){e.props.messageReceived(t)}),X.on("aciveusers",function(t){e.props.activeUsers(t)}),X.on("inactiveuser",function(t){var a;e.props.inactiveUser(t,null===(a=e.props.chatReducer)||void 0===a?void 0:a.activeusers)}),X.on("connect_error",function(a){e.props.joinSocket(X,t)})}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"validateMessageInput",value:function(){return!(""!==this.state.msg)}},{key:"render",value:function(){var e,t,a,n,r=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"chat-box-container",style:{margin:"0 auto",maxWidth:1167}},s.a.createElement("div",{className:"group-name-section"},this.state.groupname),s.a.createElement("div",{className:"row no-padding no-margin"},s.a.createElement("div",{className:"col-12 col-sm-9 no-padding no-margin"},s.a.createElement("div",{ref:this.paneDidMount,className:"message-container"},this.state.showLoading?s.a.createElement("div",{className:"chat-loader"},"Loading...."):null,(null===(e=this.props.chatReducer)||void 0===e?void 0:e.allmessages)&&0!=this.props.chatReducer.allmessages.length?this.props.chatReducer.allmessages.map(function(e,t){return s.a.createElement(B,Object.assign({},e,{key:e._id+e.createdAt+t}))}):"",s.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(e){r.messagesEnd=e}})),s.a.createElement("div",{className:"send-message-container"},s.a.createElement("form",{onSubmit:this.sendMessage},s.a.createElement("div",{className:"row no-margin no-padding"},s.a.createElement("div",{className:"col-9 col-lg-10 col-sm-9 no-margin no-padding"},s.a.createElement("input",{type:"text",className:"ipt-send-msg",value:this.state.msg,onChange:this.handleMsgChange})),s.a.createElement("div",{className:"col-3 col-lg-2 col-sm-3 no-margin no-padding"},s.a.createElement("button",{type:"submit",className:"btn-send-msg",disabled:this.validateMessageInput()},"Send")))))),s.a.createElement("div",{className:"col-sm-3 no-margin hide-sm",style:{padding:16}},s.a.createElement("div",null,(null===(t=this.props.chatReducer)||void 0===t?void 0:t.activeusers)&&0!=(null===(a=this.props.chatReducer)||void 0===a?void 0:a.activeusers.length)?null===(n=this.props.chatReducer)||void 0===n?void 0:n.activeusers.map(function(e){return s.a.createElement("div",{className:"active-user-section",key:e._id},s.a.createElement("img",{alt:"*",className:"active-user-img",onClick:r.getActiveUsers,src:K.a}),s.a.createElement("span",{className:"active-icon",style:{marginLeft:"-8px"}},s.a.createElement("img",{style:{marginTop:"20px"},src:$.a})),s.a.createElement("span",{style:{marginLeft:12}},e.name),e.groupadmin?s.a.createElement("span",{className:"message-admin"},"Admin"):null)}):"")))))}}]),a}(n.Component)),ee={joinSocket:function(e,t){return function(a){e.emit("joingroup",t,function(e){if(e.err){var t="Something went wrong";return e.err&&(t=e.err),a({type:"SHOW_NOTIFY",payload:{type:"error",message:t,dispatch:a}})}})}},sendMessage:function(e,t){return function(a){return new Promise(function(n,s){t.msg&&""!==t.msg&&e.emit("newmessage",t,function(e){if(console.log(e),!e.success){var t="Something went wrong";return e.err&&(t=e.err),a({type:"SHOW_NOTIFY",payload:{type:"error",message:t,dispatch:a}})}n(e)})})}},fetchChatHistory:function(e){return function(t){var a={method:"POST",data:{aid:e.aid,gid:e.gid,lmt:15,tim:e.tim},url:x+"/user/chat_his"};return I()(a).then(function(a){if(console.log(a),a&&a.data.success&&a.data){var n=a.data.data.allmessages.reverse();return e.previous_msg?t({type:"PREVIOUS_MESSAGES",payload:{allmessages:n}}):t({type:"CURRENT_MESSAGES",payload:{allmessages:n}}),a}return t({type:"SHOW_NOTIFY",payload:{type:"error",message:"Something went wrong",dispatch:t}})}).catch(function(e){var a="Something went wrong";return e.response&&e.response.statusText&&(a=e.response.statusText),e.response&&e.response.data&&e.response.data.err&&(a=e.response.data.err),e&&e.response&&e.response.data&&H(e.response.data||{}),t({type:"SHOW_NOTIFY",payload:{type:"error",message:a,dispatch:t}})})}},messageReceived:function(e){return function(t){return new Promise(function(a,n){if(console.log(e.data),e.data.success)t({type:"NEW_MESSAGE",payload:{message:e.data.message}}),a(!0);else if(!e.data.success){var s="Something went wrong";return e.err&&(s=e.err),t({type:"SHOW_NOTIFY",payload:{type:"error",message:s,dispatch:t}})}})}},getActiveUser:function(e){return function(t){var a={method:"POST",data:{aid:e.aid,gid:e.gid,lmt:15,tim:e.tim},url:x+"/user/chat_his"};return I()(a).then(function(a){if(a&&a.data.success&&a.data){var n=a.data.data.allmessages.reverse();return e.previous_msg?t({type:"PREVIOUS_MESSAGES",payload:{allmessages:n}}):t({type:"CURRENT_MESSAGES",payload:{allmessages:n}}),a}return t({type:"SHOW_NOTIFY",payload:{type:"error",message:"Something went wrong",dispatch:t}})}).catch(function(e){var a="Something went wrong";return e.response&&e.response.statusText&&(a=e.response.statusText),e.response&&e.response.data&&e.response.data.err&&(a=e.response.data.err),e&&e.response&&e.response.data&&H(e.response.data||{}),t({type:"SHOW_NOTIFY",payload:{type:"error",message:a,dispatch:t}})})}},activeUsers:function(e){return function(t){return console.log(e),new Promise(function(a,n){if(console.log(e.data),e.data.success)console.log("tes"),t({type:"ACTIVE_USERS",payload:{activeusers:e.data.activeusers}}),a(!0);else if(!e.data.success){var s="Something went wrong";return e.err&&(s=e.err),t({type:"SHOW_NOTIFY",payload:{type:"error",message:s,dispatch:t}})}})}},inactiveUser:function(e,t){return function(a){return new Promise(function(n,s){if(!e.success)return a({type:"SHOW_NOTIFY",payload:{type:"error",message:"Something went wrong",dispatch:a}});var r=t.findIndex(function(t){return t.socket_id==e.data.socket_id});t.splice(r,1),a({type:"ACTIVE_USERS",payload:{activeusers:t}}),n(!0)})}},checkProfanity:function(e){return function(t){var a=new J.a;a.append("text",e),a.append("lang","en"),a.append("mode","standard"),a.append("api_user",1923626804),a.append("api_secret","zK4YJa82h6wzAQyRo3sT");var n={url:"https://api.sightengine.com/1.0/text/check.json",method:"post",data:a};return I()(n).then(function(e){return console.log(e.data),e.data&&e.data.status?(console.log("hlo test"),e.data.profanity&&e.data.profanity.matches&&e.data.profanity.matches.length>0&&t({type:"SHOW_NOTIFY",payload:{type:"warning",message:"Warning: Don't use offensive words",dispatch:t}}),e):t({type:"SHOW_NOTIFY",payload:{type:"error",message:"Something went wrong",dispatch:t}})}).catch(function(e){var a="Something went wrong";return console.log(e),a=e.response?e.response.data:e.message,t({type:"SHOW_NOTIFY",payload:{type:"error",message:a,dispatch:t}})})}}},te=Object(f.f)(Object(i.b)(function(e){return{chatReducer:e.chatReducer}},ee)(Z)),ae=a(106),ne=a.n(ae),se=a(60),re=a.n(se),oe=a(47),ie=a.n(oe),ce=function(e){Object(S.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).componentDidUpdate=function(e){e.storedata!==n.props.storedata&&("error"===n.props.type||n.props.storedata&&"error"===n.props.storedata.type?n.setState({heading:"Error",img:ie.a}):"success"===n.props.type||n.props.storedata&&"success"===n.props.storedata.type?n.setState({heading:"Success",img:re.a}):"info"===n.props.type||n.props.storedata&&"info"===n.props.storedata.type?n.setState({heading:"Info",img:re.a}):"warning"===n.props.type||n.props.storedata&&"warning"===n.props.storedata.type?n.setState({heading:"Warning",img:ie.a}):n.setState({heading:"Error",img:ie.a}))},n.state={},n}return Object(y.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:this.props.show||this.props.storedata&&this.props.storedata.show?"error-popover":"error-popover hide-error-popover"},s.a.createElement("div",{className:"ep-icon-container"},s.a.createElement("img",{alt:"",className:"icon",src:this.state.img})),s.a.createElement("div",{className:"ep-content"},s.a.createElement("p",{className:"ep-heading"},this.state.heading),s.a.createElement("p",{className:"ep-msg"},this.props.message||this.props.storedata&&this.props.storedata.message)),s.a.createElement("div",{className:"close"},s.a.createElement("img",{alt:"close",onClick:this.props.hideAlert,className:"close-img",src:ne.a})))}}]),a}(n.Component);var le={hideAlert:function(){return function(e){e({type:"HIDE_NOTIFY",payload:{}})}}},pe=Object(f.f)(Object(i.b)(function(e){return{storedata:e.chatReducer.data}},le)(ce)),de=(new A.a,function(e){Object(S.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).state={isLoggedIn:!1},n}return Object(y.a)(a,[{key:"componentWillMount",value:function(){this.setState({isLoggedIn:!0})}},{key:"render",value:function(){return s.a.createElement("div",{className:"org-main-body"},s.a.createElement(pe,null),s.a.createElement("div",null,s.a.createElement(q,{loading:this.props.loading}),s.a.createElement(f.c,null,s.a.createElement(f.a,{exact:!0,path:"/",render:function(){return s.a.createElement(U,null)}}),s.a.createElement(f.a,{exact:!0,path:"/chatgroup",render:function(){return s.a.createElement(te,null)}}))))}}]),a}(n.Component)),me=(n.Component,Object(f.f)(Object(i.b)(function(e){return{loading:e.chatReducer.loading,chatReducer:e.chatReducer}},{})(de)));o.a.render(s.a.createElement(i.a,{store:g},s.a.createElement(h.a,null,s.a.createElement(f.a,{path:"/",component:me}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}).catch(function(e){console.error(e.message)})},47:function(e,t,a){e.exports=a.p+"static/media/fail.6fe44237.svg"},60:function(e,t,a){e.exports=a.p+"static/media/success.85092b97.svg"},61:function(e,t,a){}},[[111,1,2]]]);
//# sourceMappingURL=main.aea68acc.chunk.js.map